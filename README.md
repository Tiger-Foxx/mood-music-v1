# Documentation complÃ¨te de Mood Music V1 ðŸŽµâœ¨

![Mood Music Logo](public/icons/mood-249.png)

## ðŸ“– Sommaire

1. [Introduction](#introduction)
2. [Vision et concept](#vision-et-concept)
3. [Architecture technique dÃ©taillÃ©e](#architecture-technique-dÃ©taillÃ©e)
4. [FonctionnalitÃ©s principales](#fonctionnalitÃ©s-principales)
5. [Services et APIs](#services-et-apis)
6. [Composants UI et design system](#composants-ui-et-design-system)
7. [Ã‰tat du projet et roadmap](#Ã©tat-du-projet-et-roadmap)
8. [Guide d'installation et dÃ©ploiement](#guide-dinstallation-et-dÃ©ploiement)
9. [Configuration et environnement](#configuration-et-environnement)
10. [Structure du code et conventions](#structure-du-code-et-conventions)
11. [Workflows et performances](#workflows-et-performances)
12. [FAQ et troubleshooting](#faq-et-troubleshooting)
13. [Contribution et dÃ©veloppement](#contribution-et-dÃ©veloppement)
14. [Licence et crÃ©dits](#licence-et-crÃ©dits)

---

## Introduction

**Mood Music** est une application web progressive (PWA) rÃ©volutionnaire qui utilise l'intelligence artificielle pour crÃ©er une expÃ©rience musicale personnalisÃ©e en fonction de l'Ã©tat Ã©motionnel de l'utilisateur. L'application analyse l'humeur de l'utilisateur Ã  travers des descriptions textuelles ou des images et fournit des recommandations musicales adaptÃ©es via l'API Spotify.

![Screenshot de la page d'accueil](public/screenshots/home.png)

![Screenshot de l'espace d'analyse d'humeur](public/screenshots/mood-space.png)

DÃ©veloppÃ©e par [TheTigerFox](https://github.com/theTigerFox), Mood Music reprÃ©sente une convergence entre l'intelligence artificielle, le design d'expÃ©rience utilisateur avancÃ© et la passion pour la musique. Plus qu'une simple application de recommandation musicale, elle propose une nouvelle faÃ§on de dÃ©couvrir et de consommer de la musique basÃ©e sur les Ã©motions plutÃ´t que sur les genres ou artistes.

> "Ta musique en fonction de ton mood" - le slogan qui capture l'essence mÃªme de l'application.

---

## Vision et concept

### Origine du projet

Mood Music est nÃ© d'un constat simple : les plateformes de streaming musical existantes proposent principalement des recommandations basÃ©es sur des genres, des artistes similaires ou des habitudes d'Ã©coute, mais rarement sur l'Ã©tat Ã©motionnel spÃ©cifique de l'utilisateur Ã  un moment donnÃ©. Or, notre relation Ã  la musique est profondÃ©ment Ã©motionnelle.

L'idÃ©e Ã©tait donc de crÃ©er une interface qui permet Ã  l'utilisateur d'exprimer son humeur actuelle de maniÃ¨re naturelle (texte conversationnel ou image) et de recevoir instantanÃ©ment des recommandations musicales qui rÃ©sonnent avec cet Ã©tat d'esprit.

### Principes fondamentaux

1. **Empathie Ã©motionnelle** : L'application comprend vÃ©ritablement les nuances des Ã©motions humaines
2. **Design immersif** : Une expÃ©rience visuelle captivante qui amplifie l'expÃ©rience musicale
3. **AccessibilitÃ©** : Utilisable par tous, avec ou sans compte Spotify
4. **Respect de la vie privÃ©e** : Traitement minimal des donnÃ©es personnelles
5. **Progressive enhancement** : Fonctionne sur tous les appareils avec des fonctionnalitÃ©s adaptÃ©es

### Public cible

- MÃ©lomanes Ã  la recherche de nouvelles dÃ©couvertes musicales
- Personnes utilisant la musique comme support Ã©motionnel ou thÃ©rapeutique
- Utilisateurs des services de streaming musical cherchant une expÃ©rience plus personnalisÃ©e
- Amateurs de design et d'interfaces innovantes
- Curieux des applications d'intelligence artificielle dans la vie quotidienne

### DiffÃ©renciateurs clÃ©s

- **Analyse Ã©motionnelle bi-modale** : Par texte et image, contrairement aux applications qui n'utilisent que des mots-clÃ©s prÃ©dÃ©finis
- **Design immersif et Ã©motionnel** : Interface qui Ã©volue et s'adapte Ã  l'humeur dÃ©tectÃ©e
- **Exploration gÃ©ographique** : Dimension culturelle unique via la dÃ©couverte de musique par localisation
- **Interface conversationnelle** : ExpÃ©rience naturelle d'expression des Ã©motions
- **CompatibilitÃ© PWA complÃ¨te** : VÃ©ritable expÃ©rience d'application native sur tous les appareils

---

## Architecture technique dÃ©taillÃ©e

### Vue d'ensemble

Mood Music est construit sur une architecture moderne centrÃ©e sur React et TypeScript, avec une approche orientÃ©e composants et hooks personnalisÃ©s. L'application fonctionne principalement cÃ´tÃ© client, avec des interactions avec diffÃ©rentes APIs tierces pour les fonctionnalitÃ©s d'IA et de musique.

![Screenshot du diagramme](public/screenshots/diagram.png)

### Stack technologique complet

#### Frontend Core
- **React 18.2.0** : BibliothÃ¨que UI avec gestion des composants via hooks
- **TypeScript 5.0.2** : Typage statique pour la robustesse du code
- **Vite 4.3.9** : Build tool pour le dÃ©veloppement et la production
- **React Router 6.10.0** : Gestion du routage et de la navigation

#### Styling et UI
- **TailwindCSS 3.3.1** : Framework CSS utility-first
- **Tailwind Custom Extensions** : Plugins personnalisÃ©s pour animations et effets
- **FontAwesome** : BibliothÃ¨que d'icÃ´nes vectorielles
- **Google Fonts (Poppins)** : Police principale de l'application

#### State Management
- **React Context API** : Gestion d'Ã©tat global lÃ©gÃ¨re
- **Custom Hooks** : Encapsulation de la logique mÃ©tier et de l'Ã©tat

#### API Integration
- **Google Generative AI SDK** : Pour l'intÃ©gration avec Gemini AI
- **Fetch API** : Communications HTTP natives
- **OAuth 2.0** : Pour l'authentification Spotify

#### PWA Features
- **Vite PWA Plugin** : GÃ©nÃ©ration des assets et configurations PWA
- **Workbox** : Gestion avancÃ©e du service worker et des stratÃ©gies de cache
- **Web App Manifest** : Configuration pour l'installation sur appareils

#### Dev Tools
- **ESLint** : Linting et application des bonnes pratiques
- **Prettier** : Formatage cohÃ©rent du code
- **TypeScript** : VÃ©rification statique des types
- **Chrome DevTools** : Debugging et optimisation des performances

### Structure dÃ©taillÃ©e du projet

```
mood-music/
â”œâ”€â”€ public/                     # Ressources statiques
â”‚   â”œâ”€â”€ icons/                  # IcÃ´nes PWA dans diffÃ©rentes tailles
â”‚   â”‚   â”œâ”€â”€ mood-72.png
â”‚   â”‚   â”œâ”€â”€ mood-96.png
â”‚   â”‚   â”œâ”€â”€ mood-128.png
â”‚   â”‚   â”œâ”€â”€ mood-192.png
â”‚   â”‚   â”œâ”€â”€ mood-249.png        # Logo principal
â”‚   â”‚   â”œâ”€â”€ mood-512.png
â”‚   â”‚   â””â”€â”€ favicon.ico
â”‚   â”œâ”€â”€ screenshots/            # Captures d'Ã©cran de l'application
â”‚   â”‚   â”œâ”€â”€ home.png
â”‚   â”‚   â””â”€â”€ mood-space.png
â”‚   â”œâ”€â”€ splash/                 # Ã‰crans de dÃ©marrage iOS
â”‚   â”œâ”€â”€ manifest.json           # Configuration PWA
â”‚   â””â”€â”€ service-worker.js       # Service worker pour PWA
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ assets/                 # Images et ressources
â”‚   â”‚   â”œâ”€â”€ backgrounds/
â”‚   â”‚   â””â”€â”€ icons/
â”‚   â”‚
â”‚   â”œâ”€â”€ components/             # Composants React rÃ©utilisables
â”‚   â”‚   â”œâ”€â”€ common/             # Composants de base
â”‚   â”‚   â”‚   â”œâ”€â”€ Button.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Card.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ WaveAnimation.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Modal.tsx
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ layout/             # Composants de structure
â”‚   â”‚   â”‚   â”œâ”€â”€ Layout.tsx      # Layout principal avec header et footer
â”‚   â”‚   â”‚   â”œâ”€â”€ Header.tsx
â”‚   â”‚   â”‚   â””â”€â”€ Footer.tsx
â”‚   â”‚   â”œâ”€â”€ home/               # Composants spÃ©cifiques Ã  la page d'accueil
â”‚   â”‚   â”‚   â”œâ”€â”€ MoodSelector.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ RecommendedTracks.tsx
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ location/           # Composants liÃ©s Ã  la localisation
â”‚   â”‚   â”‚   â”œâ”€â”€ LocationMap.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ LocationSelector.tsx
â”‚   â”‚   â”‚   â””â”€â”€ MusicByLocation.tsx
â”‚   â”‚   â”œâ”€â”€ mood/               # Composants liÃ©s Ã  l'analyse d'humeur
â”‚   â”‚   â”‚   â”œâ”€â”€ MoodAnalyzer.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ MoodChat.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ImageUploader.tsx
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â””â”€â”€ playlist/           # Composants liÃ©s aux playlists
â”‚   â”‚       â”œâ”€â”€ PlaylistCard.tsx
â”‚   â”‚       â”œâ”€â”€ PlaylistCreator.tsx
â”‚   â”‚       â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ config/                 # Configuration de l'application
â”‚   â”‚   â”œâ”€â”€ constants.ts        # Constantes et routes
â”‚   â”‚   â””â”€â”€ gemini.ts           # Configuration de l'API Gemini
â”‚   â”‚
â”‚   â”œâ”€â”€ hooks/                  # Hooks personnalisÃ©s React
â”‚   â”‚   â”œâ”€â”€ useLocation.ts      # Gestion de la localisation
â”‚   â”‚   â”œâ”€â”€ useMood.ts          # Gestion de l'analyse d'humeur
â”‚   â”‚   â”œâ”€â”€ useMusic.ts         # Gestion des fonctionnalitÃ©s musicales
â”‚   â”‚   â””â”€â”€ useMusicPlayer.ts   # ContrÃ´le du lecteur de musique
â”‚   â”‚
â”‚   â”œâ”€â”€ pages/                  # Composants de pages principales
â”‚   â”‚   â”œâ”€â”€ Home.tsx            # Page d'accueil
â”‚   â”‚   â”œâ”€â”€ MoodSpace.tsx       # Page d'analyse d'humeur
â”‚   â”‚   â”œâ”€â”€ LocationMusic.tsx   # Page de musique par localisation
â”‚   â”‚   â”œâ”€â”€ Playlists.tsx       # Page de gestion des playlists
â”‚   â”‚   â”œâ”€â”€ About.tsx           # Page Ã€ propos
â”‚   â”‚   â”œâ”€â”€ Contact.tsx         # Page Contact
â”‚   â”‚   â””â”€â”€ Privacy.tsx         # Politique de confidentialitÃ©
â”‚   â”‚
â”‚   â”œâ”€â”€ services/               # Services et logique mÃ©tier
â”‚   â”‚   â”œâ”€â”€ ai.ts               # Service d'analyse par IA
â”‚   â”‚   â”œâ”€â”€ location.ts         # Service de localisation
â”‚   â”‚   â”œâ”€â”€ music.ts            # Service de gestion musicale
â”‚   â”‚   â””â”€â”€ storage.ts          # Service de stockage local
â”‚   â”‚
â”‚   â”œâ”€â”€ styles/                 # Styles globaux et utilitaires
â”‚   â”‚   â””â”€â”€ tailwind.css        # Imports et personnalisations TailwindCSS
â”‚   â”‚
â”‚   â”œâ”€â”€ types/                  # DÃ©finitions TypeScript
â”‚   â”‚   â”œâ”€â”€ location.ts         # Types liÃ©s Ã  la localisation
â”‚   â”‚   â”œâ”€â”€ mood.ts             # Types liÃ©s Ã  l'humeur
â”‚   â”‚   â””â”€â”€ music.ts            # Types liÃ©s Ã  la musique
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/                  # Fonctions utilitaires
â”‚   â”‚   â”œâ”€â”€ api.ts              # Utilitaires API
â”‚   â”‚   â”œâ”€â”€ formatters.ts       # Formatage de donnÃ©es
â”‚   â”‚   â””â”€â”€ moodAnalysis.ts     # Analyse d'humeur
â”‚   â”‚
â”‚   â”œâ”€â”€ App.tsx                 # Composant racine
â”‚   â”œâ”€â”€ App.css                 # Styles spÃ©cifiques Ã  l'application
â”‚   â”œâ”€â”€ index.css               # Styles globaux
â”‚   â”œâ”€â”€ main.tsx                # Point d'entrÃ©e de l'application
â”‚   â””â”€â”€ vite-env.d.ts           # Types pour Vite
â”‚
â”œâ”€â”€ .env.example                # Exemple de configuration des variables d'environnement
â”œâ”€â”€ .gitignore                  # Fichiers et dossiers ignorÃ©s par Git
â”œâ”€â”€ index.html                  # Point d'entrÃ©e HTML
â”œâ”€â”€ package.json                # DÃ©pendances et scripts
â”œâ”€â”€ postcss.config.js           # Configuration PostCSS
â”œâ”€â”€ tailwind.config.js          # Configuration de TailwindCSS
â”œâ”€â”€ tsconfig.json               # Configuration TypeScript
â”œâ”€â”€ vite.config.ts              # Configuration Vite
â””â”€â”€ README.md                   # Documentation du projet
```

### Flux de donnÃ©es principaux

#### Flux d'analyse d'humeur et recommandation
```mermaid
sequenceDiagram
    participant User
    participant UI as Interface Utilisateur
    participant MoodHook as useMood Hook
    participant AIService as Service IA
    participant SpotifyService as Service Spotify
    participant Storage as LocalStorage

    User->>UI: Saisit description d'humeur
    UI->>MoodHook: Transmet le texte
    MoodHook->>AIService: Envoie texte pour analyse
    AIService->>+GeminiAI: RequÃªte d'analyse
    GeminiAI-->>-AIService: Retourne tags d'humeur
    AIService-->>MoodHook: Retourne analyse
    MoodHook->>Storage: Sauvegarde analyse localement
    MoodHook->>SpotifyService: Demande recommandations avec tags
    SpotifyService->>+SpotifyAPI: RequÃªte API
    SpotifyAPI-->>-SpotifyService: Retourne recommendations
    SpotifyService-->>MoodHook: Retourne tracks
    MoodHook-->>UI: Met Ã  jour avec recommandations
    UI-->>User: Affiche recommandations musicales
```

#### Flux d'authentification Spotify
```mermaid
sequenceDiagram
    participant User
    participant App as Application
    participant SpotifyService as Service Spotify
    participant SpotifyAuth as Auth Spotify
    participant API as Spotify API
    participant Storage as LocalStorage

    User->>App: Clic "Se connecter"
    App->>SpotifyService: Lance authentification
    SpotifyService->>+SpotifyAuth: GÃ©nÃ¨re URL OAuth
    SpotifyAuth-->>-SpotifyService: URL d'authentification
    SpotifyService-->>App: Redirige vers Spotify
    App-->>User: Affiche page login Spotify
    User->>SpotifyAuth: S'authentifie et autorise
    SpotifyAuth-->>App: Callback avec code auth
    App->>SpotifyService: Ã‰change code contre token
    SpotifyService->>+API: RequÃªte token
    API-->>-SpotifyService: Access & Refresh tokens
    SpotifyService->>Storage: Stocke tokens sÃ©curisÃ©s
    SpotifyService-->>App: Confirmation authentification
    App-->>User: Affiche interface connectÃ©e
```

### ModÃ¨le de donnÃ©es

#### Types principaux
```typescript
// Types liÃ©s Ã  l'humeur
interface MoodTags {
    emotions: string[];        // ex: ['joyeux', 'excitÃ©']
    intensity: number;         // 0-100
    genres: string[];          // ex: ['pop', 'dance']
    tempo: string[];           // ex: ['rapide', 'Ã©nergique']
    atmosphere: string[];      // ex: ['festive', 'lÃ©gÃ¨re']
    instruments: string[];     // ex: ['guitare', 'synthÃ©tiseur']
    eras: string[];            // ex: ['annÃ©es 80', 'contemporain']
    artists: string[];         // ex: ['Daft Punk', 'The Weeknd']
    tracks: string[];          // ex: ['Blinding Lights']
}

// Type pour une analyse d'image
interface ImageTags extends Omit<MoodTags, 'eras'> {
    colors: string[];          // ex: ['bleu', 'violet']
    time: string[];            // ex: ['nuit', 'crÃ©puscule']
    season: string[];          // ex: ['Ã©tÃ©', 'automne']
}

// Type pour un morceau de musique
interface Track {
    id: string;
    name: string;
    uri: string;
    preview_url: string | null;
    popularity: number;
    artists: {
        id: string;
        name: string;
        uri: string;
    }[];
    album: {
        id: string;
        name: string;
        release_date: string;
        images: {
            url: string;
            height: number;
            width: number;
        }[];
    };
    external_urls: {
        spotify: string;
    };
}

// Type pour une localisation
interface Location {
    latitude: number;
    longitude: number;
    country: string;
    countryCode: string;
    city?: string;
    region?: string;
    displayName: string;
}

// Type pour un message du chat
interface ChatMessage {
    id: string;
    content: string;
    role: 'user' | 'assistant';
    timestamp: Date;
    imageUrl?: string;
    tags?: MoodTags | ImageTags;
}
```

---

## FonctionnalitÃ©s principales

### 1. Analyse d'humeur par IA

#### Analyse textuelle
- **Interface conversationnelle** avec l'assistant IA "Moody"
- Traitement du **langage naturel** pour comprendre les nuances Ã©motionnelles
- Extraction de paramÃ¨tres Ã©motionnels et musicaux via l'API Google Gemini
- SystÃ¨me de tagging multi-dimensionnel (Ã©motions, intensitÃ©, genres, tempo, ambiance...)
- Support de descriptions complexes et contextuelles

```typescript
// Extrait simplifiÃ© du processus d'analyse textuelle
export const analyzeMoodFromText = async (text: string): Promise<MoodAnalysisResponse> => {
  // Configuration de l'API Gemini
  const model = geminiAI.getGenerativeModel({ model: "gemini-2.0-flash" });
  
  // Prompt systÃ¨me optimisÃ© pour l'analyse d'humeur
  const systemPrompt = `${moodAnalysisSystemPrompt}\n\n`;
  
  // CrÃ©ation de la session de chat avec l'IA
  const chat = model.startChat({
    generationConfig: { temperature: 0.7, topK: 40, maxOutputTokens: 1024 },
    history: [
      { role: "user", parts: [{ text: "..." }]},
      { role: "model", parts: [{ text: "..." }]},
      { role: "user", parts: [{ text: systemPrompt }]},
    ]
  });
  
  // Envoi du texte utilisateur et rÃ©cupÃ©ration de l'analyse
  const result = await chat.sendMessage(text);
  const content = result.response.text();
  
  // Extraction et validation des donnÃ©es JSON
  const moodTags = extractMoodTagsFromResponse(content);
  
  return {
    response: createConversationalResponse(moodTags),
    moodTags: ensureValidMoodTags(moodTags),
    rawResponse: content
  };
};
```

#### Analyse d'image
- **Upload d'images** depuis l'appareil
- Analyse visuelle par **vision artificielle** (Gemini Vision)
- DÃ©tection du contenu, des couleurs, compositions et ambiances
- Traduction des Ã©lÃ©ments visuels en paramÃ¨tres musicaux
- Interface visuelle intuitive avec prÃ©visualisation et feedback

#### SystÃ¨me de tagging sophistiquÃ©
Le systÃ¨me de tags est le cÅ“ur de l'analyse d'humeur, avec des champs multiples :

- **Ã‰motions** : Identifie les Ã©motions principales (joie, tristesse, nostalgie, etc.)
- **IntensitÃ©** : Ã‰chelle de 0-100 pour calibrer l'Ã©nergie des recommandations
- **Genres** : Styles musicaux correspondant Ã  l'humeur
- **Tempo** : Rythme musical adaptÃ© (lent, modÃ©rÃ©, rapide)
- **Ambiance** : AtmosphÃ¨re gÃ©nÃ©rale (apaisante, Ã©nergique, festive, etc.)
- **Instruments** : Instruments qui rÃ©sonnent avec l'humeur
- **Ãˆres** : PÃ©riodes musicales pertinentes (annÃ©es 80, contemporain, etc.)
- **Artistes** : Suggestions d'artistes spÃ©cifiques (nouveautÃ© rÃ©cente)
- **Chansons** : Titres particuliers recommandÃ©s (nouveautÃ© rÃ©cente)

Pour les images, des tags spÃ©cifiques sont ajoutÃ©s :
- **Couleurs** : Palette de couleurs dominantes
- **Moment** : PÃ©riode de la journÃ©e Ã©voquÃ©e (aube, jour, crÃ©puscule, nuit)
- **Saison** : Saison Ã©voquÃ©e (printemps, Ã©tÃ©, automne, hiver)

### 2. Recommandations musicales intelligentes

#### SystÃ¨me de recommandation hybride
- **Analyse Ã©motionnelle** : Traduit les tags d'humeur en paramÃ¨tres de recherche musicale
- **IntÃ©gration Spotify** : Utilisation de l'API de recherche et de recommandation
- **Recommandation par artiste** : Priorisation des artistes suggÃ©rÃ©s par l'IA
- **Fallbacks intelligents** : SystÃ¨me Ã  plusieurs niveaux pour garantir des rÃ©sultats pertinents
- **Filtrage adaptatif** : Ajustement des recommandations selon l'intensitÃ© Ã©motionnelle

```typescript
// Extrait du systÃ¨me de recommandation musical
async searchByMoodTags(moodTags: MoodTags, limit: number = 10): Promise<Track[]> {
  try {
    console.log('Recherche basÃ©e sur les tags d\'humeur:', moodTags);

    // 1. Priorisation des artistes suggÃ©rÃ©s par l'IA
    let searchQuery = '';
    if (moodTags.artists && moodTags.artists.length > 0) {
      const artist = moodTags.artists[0];
      searchQuery = `artist:"${artist}"`;
      // Ajouter un titre spÃ©cifique si suggÃ©rÃ©
      if (moodTags.tracks && moodTags.tracks.length > 0) {
        searchQuery += ` track:"${moodTags.tracks[0]}"`;
      }
    }
    // 2. Utiliser les genres comme fallback
    else if (moodTags.genres && moodTags.genres.length > 0) {
      const validGenres = moodTags.genres.filter(genre => 
          SAFE_SPOTIFY_GENRES.includes(genre.toLowerCase())
      );
      searchQuery = validGenres.length > 0 ? 
        `genre:${validGenres[0]}` : 'genre:pop';
    }
    // 3. Dernier recours
    else {
      searchQuery = 'genre:pop';
    }

    // Enrichir la requÃªte avec l'ambiance
    if (moodTags.atmosphere && moodTags.atmosphere.length > 0) {
      searchQuery += ` ${moodTags.atmosphere[0]}`;
    }
    
    // ExÃ©cuter la recherche
    const response = await this.search(searchQuery, 'track', limit);
    
    // GÃ©rer les fallbacks si nÃ©cessaire
    // [Code de fallback omis pour concision]
    
    return tracks;
  } catch (error) {
    console.error('Erreur lors de la recherche par tags d\'humeur:', error);
    return this.searchTracksByGenre('pop', limit); // Fallback sÃ»r
  }
}
```

#### Interface de dÃ©couverte musicale
- **PrÃ©visualisation audio** des morceaux recommandÃ©s
- **Informations dÃ©taillÃ©es** sur les artistes et albums
- **Cartes interactives** avec contrÃ´les de lecture
- **Liens directs** vers Spotify pour l'Ã©coute intÃ©grale
- **CrÃ©ation de playlist** Ã  partir des recommandations

#### AdaptÃ© aux utilisateurs non connectÃ©s
- ExpÃ©rience complÃ¨te mÃªme sans compte Spotify
- PrÃ©visualisations audio disponibles sans authentification
- Informations complÃ¨tes sur les morceaux et artistes
- PossibilitÃ© de s'authentifier Ã  tout moment pour enrichir l'expÃ©rience

### 3. Exploration musicale par localisation

#### FonctionnalitÃ©s de gÃ©olocalisation
- **DÃ©tection automatique** de la position de l'utilisateur
- **Recherche de lieux** pour explorer diffÃ©rentes rÃ©gions
- **Cartographie interactive** pour la sÃ©lection des lieux
- **Affichage des tendances rÃ©gionales** musicales
- **Interface adaptative** entre mobile et desktop

```typescript
// Extrait du service de recommandation musicale par localisation
async getTopTracksByCountry(countryCode: string, limit: number = 10): Promise<Track[]> {
  try {
    console.log(`Recherche de morceaux pour le pays: ${countryCode}`);
    
    // Valider et normaliser le code pays
    if (!countryCode || countryCode.trim().length !== 2) {
      countryCode = 'FR'; // Fallback vers la France
    }
    
    // Obtenir le nom complet du pays
    let countryName = new Intl.DisplayNames(['fr'], { type: 'region' }).of(countryCode);
    
    // StratÃ©gie 1: "music from [pays]"
    let searchResponse = await this.search(`music from ${countryName}`, 'track', limit);
    if (searchResponse?.tracks?.items?.length > 0) {
      return searchResponse.tracks.items;
    }
    
    // StratÃ©gie 2: Recherche directe du nom du pays
    searchResponse = await this.search(countryName, 'track', limit);
    if (searchResponse?.tracks?.items?.length > 0) {
      return searchResponse.tracks.items;
    }
    
    // StratÃ©gie 3: "popular music [pays]"
    searchResponse = await this.search(`popular music ${countryName}`, 'track', limit);
    if (searchResponse?.tracks?.items?.length > 0) {
      return searchResponse.tracks.items;
    }
    
    // Fallback vers la France si diffÃ©rent
    if (countryCode !== 'FR') {
      return this.getTopTracksByCountry('FR', limit);
    }
    
    // Dernier recours: recherche gÃ©nÃ©rique
    return this.search('popular music', 'track', limit).tracks?.items || [];
  } catch (error) {
    console.error(`Erreur lors de la recherche par pays ${countryCode}:`, error);
    return countryCode !== 'FR' ? 
      this.getTopTracksByCountry('FR', limit) : [];
  }
}
```

#### Interface cartographique
- Visualisation de la localisation sÃ©lectionnÃ©e
- Carte interactive basÃ©e sur OpenStreetMap
- Adaptation aux Ã©crans mobiles et desktop
- Transitions fluides entre les diffÃ©rentes rÃ©gions

### 4. Interface utilisateur avancÃ©e

#### Design systÃ¨me cohÃ©rent
- **ThÃ¨me sombre immersif** avec accents de couleur violets et bleus
- **Glassmorphisme** et effets de transparence pour une esthÃ©tique moderne
- **Animations fluides** pour une expÃ©rience dynamique
- **Composants rÃ©utilisables** pour une cohÃ©rence visuelle
- **Micro-interactions** pour un feedback instantanÃ©

#### Components UI principaux
- **Cards** : Conteneurs principaux avec effets visuels avancÃ©s
- **Buttons** : Boutons personnalisÃ©s avec variantes et Ã©tats
- **Wave Animation** : Animations fluides pour les fonds
- **Music Player** : Lecteur audio intÃ©grÃ© pour les prÃ©visualisations
- **Chat Interface** : Interface conversationnelle pour l'analyse d'humeur
- **Image Uploader** : SystÃ¨me de tÃ©lÃ©chargement d'images avec prÃ©visualisation

```tsx
// Exemple du composant Card avec variantes de style
const Card: React.FC<CardProps> = ({
  children,
  className = "",
  variant = "default",
  padding = "default",
  shadow = "default",
  hover = false,
  onClick
}) => {
  // DÃ©finition des classes conditionnelles
  const variantClasses = {
    default: "bg-gray-900/90 border border-white/10",
    glass: "bg-white/5 backdrop-blur-sm border border-white/10",
    gradient: `bg-gradient-to-br from-purple-900/50 via-purple-800/30 to-blue-900/40 
               border border-white/10`,
    dark: "bg-black/80 border border-gray-800/80"
  };
  
  const paddingClasses = {
    none: "",
    small: "p-3",
    default: "p-6",
    large: "p-8"
  };
  
  const shadowClasses = {
    none: "",
    default: "shadow-md",
    lg: "shadow-lg",
    xl: "shadow-xl"
  };
  
  const hoverClass = hover ? "transition-all duration-300 hover:bg-white/10" : "";
  
  return (
    <div
      className={`rounded-xl ${variantClasses[variant]} ${paddingClasses[padding]} 
                  ${shadowClasses[shadow]} ${hoverClass} ${className}`}
      onClick={onClick}
    >
      {children}
    </div>
  );
};
```

#### Responsive design avancÃ©
- **Mobile-first approach** avec adaptations spÃ©cifiques
- **Interfaces diffÃ©renciÃ©es** entre mobile et desktop
- **ContrÃ´les adaptÃ©s** aux interactions tactiles et souris
- **Media queries** pour tous les breakpoints
- **Animations optimisÃ©es** selon les capacitÃ©s de l'appareil

### 5. FonctionnalitÃ©s PWA

#### Installation sur appareils
- **Manifeste complet** : Configuration pour l'installation sur iOS et Android
- **IcÃ´nes adaptatives** : Images optimisÃ©es pour tous les appareils
- **Splash screens** : Ã‰crans de chargement personnalisÃ©s pour iOS
- **DÃ©tection d'installation** : Invite d'installation intelligente

#### Service worker et performances
- **Mise en cache stratÃ©gique** des ressources statiques
- **StratÃ©gies diffÃ©renciÃ©es** selon les types de contenus
- **Gestion hors-ligne** avec page de fallback
- **Mises Ã  jour intelligentes** avec notifications

#### Optimisation pour mobiles
- **Interactions tactiles** optimisÃ©es
- **Boutons accessibles** et suffisamment larges
- **DonnÃ©es locales** pour minimiser la consommation rÃ©seau
- **Performances optimisÃ©es** pour les appareils moins puissants

### 6. Autres fonctionnalitÃ©s notables

#### Historique d'humeur
- **Sauvegarde locale** des analyses d'humeur prÃ©cÃ©dentes
- **Visualisation de l'historique** avec donnÃ©es clÃ©s
- **Rappel des recommandations** passÃ©es
- **Gestion et suppression** des entrÃ©es

#### Pages informatives
- **Page Ã€ propos** : Description du projet et du dÃ©veloppeur
- **Page Contact** : Informations de contact et rÃ©seaux sociaux
- **Page ConfidentialitÃ©** : Politique dÃ©taillÃ©e sur la gestion des donnÃ©es

#### Authentification Spotify
- **OAuth 2.0** pour une authentification sÃ©curisÃ©e
- **Stockage sÃ©curisÃ©** des tokens
- **Refresh automatique** des tokens expirÃ©s
- **DÃ©connexion** avec nettoyage des donnÃ©es

---

## Services et APIs

### Service d'IA (ai.service.ts)

Le service d'IA est le composant central pour l'analyse d'humeur, utilisant l'API Google Gemini pour comprendre les Ã©motions exprimÃ©es par l'utilisateur. Il gÃ¨re Ã  la fois l'analyse de texte et d'image.

#### FonctionnalitÃ©s principales
- **Analyse de texte** : Traitement du langage naturel pour extraire des Ã©motions et prÃ©fÃ©rences musicales
- **Analyse d'image** : Vision par ordinateur pour dÃ©tecter l'ambiance visuelle
- **Extraction de tags** : SystÃ¨me sophistiquÃ© de catÃ©gorisation Ã©motionnelle et musicale
- **Gestion des prompts** : Optimisation des instructions pour l'IA

```typescript
// Structure simplifiÃ©e du service AI
export class AIService {
  private genAI: GoogleGenerativeAI;
  private model: any;

  constructor() {
    this.genAI = new GoogleGenerativeAI(GEMINI_API_KEY);
    this.model = this.genAI.getGenerativeModel({ 
      model: "gemini-2.0-flash" 
    });
  }

  /**
   * Analyse une description textuelle de l'humeur
   */
  async analyzeMood(moodDescription: string): Promise<MoodAnalysisResponse> {
    // Configuration et sÃ©curitÃ©
    // CrÃ©ation du chat avec prompt systÃ¨me
    // Envoi de la requÃªte Ã  l'API
    // Traitement de la rÃ©ponse et extraction des tags
    // Validation et enrichissement des donnÃ©es
    // Gestion des erreurs et fallbacks
  }

  /**
   * Analyse une image pour en extraire l'ambiance
   */
  async analyzeImage(imageBase64: string): Promise<ImageAnalysisResponse> {
    // Configuration du modÃ¨le de vision
    // PrÃ©paration de l'image
    // Envoi Ã  l'API Gemini Vision
    // Traitement de la rÃ©ponse
    // Extraction des tags visuels et Ã©motionnels
    // Validation et enrichissement
    // Gestion des erreurs et fallbacks
  }
}
```

#### Configuration des prompts
Les prompts systÃ¨me sont soigneusement conÃ§us pour guider l'IA vers une analyse Ã©motionnelle pertinente :

```typescript
// Exemple de prompt systÃ¨me pour l'analyse d'humeur
export const moodAnalysisSystemPrompt = `
Tu es Moody, un assistant conversationnel spÃ©cialisÃ© dans l'analyse d'humeur et la recommandation musicale.

IMPORTANT: Tu dois ABSOLUMENT rÃ©pondre UNIQUEMENT en format JSON, avec la structure exacte suivante et rien d'autre :
{
  "response": "Ta rÃ©ponse conversationnelle ici...",
  "moodTags": {
    "emotions": [...],
    "intensity": (nombre entre 0 et 100),
    "genres": [...],
    "tempo": [...],
    "atmosphere": [...],
    "instruments": [...],
    "eras": [...],
    "artists": [...],
    "tracks": [...]
  }
}

Ta mission est d'analyser la description d'humeur fournie et d'extraire des tags pertinents pour la recherche musicale.
[Instructions dÃ©taillÃ©es sur l'analyse Ã©motionnelle...]

TOUS les champs doivent Ãªtre prÃ©sents et le champ "artists" ne doit jamais Ãªtre vide.
`;
```

### Service musical (music.service.ts)

Ce service gÃ¨re toute l'interaction avec l'API Spotify, depuis l'authentification jusqu'aux recommandations musicales.

#### FonctionnalitÃ©s principales
- **Authentification OAuth** : Gestion complÃ¨te du flux OAuth 2.0 pour Spotify
- **Recherche musicale** : RequÃªtes de recherche adaptÃ©es aux tags d'humeur
- **Recommandations** : Algorithme de recommandations musicales Ã  plusieurs niveaux
- **Gestion de playlists** : CrÃ©ation et modification de playlists Spotify
- **Localisation musicale** : Recommandations adaptÃ©es Ã  la rÃ©gion gÃ©ographique

```typescript
// Structure simplifiÃ©e du service musical
export class MusicService {
  private clientId: string;
  private redirectUri: string;
  private tokenData: TokenData | null = null;
  private clientTokenData: ClientTokenData | null = null;

  constructor() {
    this.clientId = import.meta.env.VITE_SPOTIFY_CLIENT_ID;
    this.redirectUri = import.meta.env.VITE_SPOTIFY_REDIRECT_URI;
    this.loadTokensFromStorage();
  }

  /**
   * Authentification et gestion des tokens
   */
  generateAuthUrl(): string {...}
  exchangeAuthCode(code: string): Promise<TokenData> {...}
  getClientCredentialsToken(): Promise<ClientTokenData> {...}
  refreshAccessToken(): Promise<TokenData> {...}
  
  /**
   * RequÃªtes API Spotify
   */
  async search(query: string, type: string, limit: number): Promise<any> {...}
  async getRecommendations(params: Record<string, any>): Promise<any> {...}
  
  /**
   * MÃ©thodes de recherche spÃ©cialisÃ©es
   */
  async searchTracksByGenre(genre: string, limit: number): Promise<Track[]> {...}
  async searchByMoodTags(moodTags: MoodTags, limit: number): Promise<Track[]> {...}
  async searchByArtist(artistName: string, limit: number): Promise<Track[]> {...}
  async getTopTracksByCountry(countryCode: string, limit: number): Promise<Track[]> {...}
  
  /**
   * Gestion des playlists
   */
  async getUserPlaylists(): Promise<any> {...}
  async createPlaylist(name: string, description: string, isPublic: boolean, trackUris: string[]): Promise<any> {...}
}
```

### Service de localisation (location.service.ts)

Ce service gÃ¨re la dÃ©tection et la gestion des localisations gÃ©ographiques pour les recommandations musicales par rÃ©gion.

#### FonctionnalitÃ©s principales
- **GÃ©olocalisation** : DÃ©tection de la position de l'utilisateur
- **Recherche de lieux** : Recherche gÃ©ographique par nom
- **Geocoding inverse** : Conversion de coordonnÃ©es en informations de lieu
- **Stockage local** : Sauvegarde des lieux favoris ou rÃ©cemment visitÃ©s

### Service de stockage (storage.service.ts)

Service responsable de la persistance locale des donnÃ©es utilisateur et des prÃ©fÃ©rences.

#### FonctionnalitÃ©s principales
- **Historique d'humeur** : Sauvegarde des analyses d'humeur prÃ©cÃ©dentes
- **Stockage des tokens** : Gestion sÃ©curisÃ©e des tokens d'authentification
- **PrÃ©fÃ©rences utilisateur** : Sauvegarde des paramÃ¨tres personnalisÃ©s
- **Cache de donnÃ©es** : Mise en cache des rÃ©ponses API frÃ©quemment utilisÃ©es

---

## Composants UI et design system

### Principes de design

Mood Music utilise un systÃ¨me de design cohÃ©rent et immersif qui s'articule autour de plusieurs principes clÃ©s :

1. **Interface sombre et immersive** : ThÃ¨me dark adaptÃ© Ã  l'expÃ©rience musicale
2. **Glassmorphisme** : Effets de transparence et de flou pour une profondeur visuelle
3. **DÃ©gradÃ©s subtils** : Palette de couleurs avec violet et bleu comme teintes principales
4. **Typographie claire** : Police Poppins pour une lisibilitÃ© optimale
5. **Composants arrondis** : Coins arrondis pour une esthÃ©tique contemporaine
6. **Animations fluides** : Transitions douces et rÃ©actives
7. **Micro-interactions** : Feedback visuel pour toutes les actions utilisateur

### Palette de couleurs

```css
/* Couleurs principales */
--color-bg-primary: #0a0a0a;       /* ArriÃ¨re-plan principal */
--color-bg-secondary: #111111;      /* ArriÃ¨re-plan secondaire */
--color-purple-primary: #8B5CF6;    /* Accent violet primaire */
--color-blue-primary: #3B82F6;      /* Accent bleu primaire */
--color-text-primary: #ffffff;      /* Texte principal */
--color-text-secondary: #d1d5db;    /* Texte secondaire */
--color-text-tertiary: #9CA3AF;     /* Texte tertiaire */
--color-surface: rgba(255, 255, 255, 0.05);  /* Surface des cartes */
--color-border: rgba(255, 255, 255, 0.1);    /* Bordures subtiles */
--color-overlay: rgba(0, 0, 0, 0.7);         /* Overlay pour modales */
```

### Composants principaux

#### Button

Bouton polyvalent avec plusieurs variantes et Ã©tats.

```tsx
<Button
  variant="primary | secondary | glass | outline"
  size="sm | md | lg"
  rounded="default | full"
  icon={<i className="fas fa-icon"></i>}
  disabled={false}
  fullWidth={false}
  className="custom-class"
  onClick={handleClick}
>
  Texte du bouton
</Button>
```

#### Card

Conteneur principal avec effets visuels adaptables.

```tsx
<Card
  variant="default | glass | gradient | dark"
  padding="none | small | default | large"
  shadow="none | default | lg | xl"
  hover={false}
  className="custom-class"
  onClick={handleCardClick}
>
  Contenu de la carte
</Card>
```

#### Modal

FenÃªtre modale pour dialogues et notifications.

```tsx
<Modal
  isOpen={isModalOpen}
  onClose={handleCloseModal}
  title="Titre de la modale"
>
  Contenu de la modale
</Modal>
```

#### WaveAnimation

Animation de vague pour fonds dynamiques.

```tsx
<WaveAnimation
  className="absolute inset-0"
  height={300}
  amplitude={0.5}
  color="rgba(139, 92, 246, 0.15)"
/>
```

#### MoodSelector

SÃ©lecteur rapide d'humeurs prÃ©dÃ©finies.

```tsx
<MoodSelector
  selectedMood={currentMood}
  onMoodSelect={handleMoodSelect}
  className="mt-6"
/>
```

#### MoodChat

Interface de chat pour l'analyse textuelle d'humeur.

```tsx
<MoodChat
  messages={messages}
  isAnalyzing={isAnalyzing}
  onSendMessage={handleSendMessage}
/>
```

#### ImageUploader

Composant de tÃ©lÃ©chargement d'images avec prÃ©visualisation.

```tsx
<ImageUploader
  onImageSelect={handleImageSelect}
  isLoading={isUploading}
/>
```

#### LocationMap

Carte interactive pour la visualisation gÃ©ographique.

```tsx
<LocationMap
  location={selectedLocation}
  height="250px"
/>
```

### Media queries et responsive design

L'application utilise des breakpoints Tailwind standards pour une adaptation optimale Ã  tous les Ã©crans :

```css
/* Breakpoints */
--screen-sm: 640px;   /* Small devices */
--screen-md: 768px;   /* Medium devices */
--screen-lg: 1024px;  /* Large devices */
--screen-xl: 1280px;  /* Extra large devices */
--screen-2xl: 1536px; /* 2X Extra large devices */
```

Ces breakpoints sont utilisÃ©s de faÃ§on cohÃ©rente dans toute l'application :

```html
<!-- Exemple d'utilisation responsive -->
<div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
  <!-- Contenu qui s'adapte du mobile au desktop -->
</div>
```

### Animations et transitions

L'application utilise plusieurs types d'animations pour amÃ©liorer l'expÃ©rience utilisateur :

1. **Transitions de page** : Animations subtiles entre les pages
2. **Animations de chargement** : Spinners et skeletons pendant les chargements
3. **Micro-animations** : Feedback visuel pour les interactions (hover, focus, click)
4. **Animations d'ambiance** : Vagues et particules pour l'arriÃ¨re-plan

```css
/* Exemples d'animations */
.fade-in {
  animation: fadeIn 0.5s ease-in;
}

.slide-up {
  animation: slideUp 0.3s ease-out;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes slideUp {
  from { transform: translateY(20px); opacity: 0; }
  to { transform: translateY(0); opacity: 1; }
}
```

---

## Ã‰tat du projet et roadmap

### Ã‰tat actuel du dÃ©veloppement

Mood Music est actuellement en version **1.2.0**, avec les fonctionnalitÃ©s suivantes pleinement opÃ©rationnelles :

- âœ… Analyse d'humeur par texte avec Google Gemini
- âœ… Analyse d'image avec Gemini Vision
- âœ… Recommandations musicales via Spotify API
- âœ… Exploration musicale par localisation
- âœ… Interface utilisateur responsive et animations
- âœ… FonctionnalitÃ©s PWA complÃ¨tes
- âœ… Authentification Spotify OAuth
- âœ… Pages Ã€ propos, Contact et ConfidentialitÃ©

### Roadmap des fonctionnalitÃ©s

#### Version 1.3.0 (Prochain trimestre)
- [ ] AmÃ©lioration du systÃ¨me de recommandation avec des attributs audio (danse, Ã©nergie, etc.)
- [ ] IntÃ©gration des mÃ©tadonnÃ©es des morceaux (BPM, key, etc.) dans l'interface
- [ ] Support multilingue (franÃ§ais, anglais, espagnol)
- [ ] ThÃ¨me clair en option
- [ ] Widget exportable pour intÃ©gration sur d'autres sites

#### Version 1.4.0 (Ã€ moyen terme)
- [ ] Mode collaboratif pour crÃ©er des playlists Ã  plusieurs
- [ ] Analyse d'humeur par reconnaissance vocale
- [ ] Statistiques personnelles sur l'Ã©volution des humeurs musicales
- [ ] Visualisations audio avancÃ©es pendant la lecture
- [ ] AmÃ©lioration des recommandations hors ligne

#### Version 2.0.0 (Ã€ long terme)
- [ ] IntÃ©gration avec d'autres services de streaming (Apple Music, Deezer)
- [ ] FonctionnalitÃ©s sociales (partage de playlists d'humeur)
- [ ] ModÃ¨le d'IA personnalisÃ© qui apprend des prÃ©fÃ©rences utilisateur
- [ ] API publique pour dÃ©veloppeurs tiers
- [ ] Applications natives iOS et Android

### ProblÃ¨mes connus et limitations

1. **API Spotify** : Certains endpoints ont des quotas limitÃ©s
2. **Google Gemini** : RÃ©ponses parfois inconsistantes dans le format attendu
3. **Recommandation** : Les genres spÃ©cifiques peuvent manquer de rÃ©sultats
4. **PWA** : Certaines fonctionnalitÃ©s limitÃ©es sur iOS
5. **Localisation** : PrÃ©cision variable selon les rÃ©gions

### PrioritÃ©s de dÃ©veloppement

1. **StabilitÃ©** : AmÃ©lioration de la gestion des erreurs et des cas limites
2. **Performance** : Optimisations pour les appareils moins puissants
3. **AccessibilitÃ©** : ConformitÃ© WCAG et test avec lecteurs d'Ã©cran
4. **Internationalisation** : Support de langues multiples
5. **Offline** : AmÃ©lioration de l'expÃ©rience hors-ligne

---

## Guide d'installation et dÃ©ploiement

### PrÃ©requis

- **Node.js** : v16.0.0 ou supÃ©rieur
- **npm** : v8.0.0 ou supÃ©rieur (ou yarn)
- **Git** : Pour cloner le dÃ©pÃ´t
- **Compte dÃ©veloppeur Spotify** : Pour les clÃ©s API
- **Compte Google AI** : Pour accÃ©der Ã  l'API Gemini

### Installation locale

```bash
# 1. Cloner le dÃ©pÃ´t
git clone https://github.com/theTigerFox/mood-music.git
cd mood-music

# 2. Installer les dÃ©pendances
npm install
# ou
yarn

# 3. Copier le fichier d'environnement exemple
cp .env.example .env

# 4. Ã‰diter le fichier .env avec vos identifiants API
# VITE_SPOTIFY_CLIENT_ID=your_spotify_client_id
# VITE_SPOTIFY_CLIENT_SECRET=your_spotify_client_secret
# VITE_SPOTIFY_REDIRECT_URI=http://localhost:3000/callback
# VITE_GEMINI_API_KEY=your_gemini_api_key

# 5. Lancer l'application en mode dÃ©veloppement
npm run dev
# ou
yarn dev
```

### Configuration des clÃ©s API

#### Spotify API
1. CrÃ©er une application sur [Spotify Developer Dashboard](https://developer.spotify.com/dashboard/)
2. Noter le Client ID et Client Secret
3. Configurer les URLs de redirection (ajouter `http://localhost:3000/callback` pour le dÃ©veloppement)
4. Ajouter les identifiants dans votre fichier `.env`

#### Google Gemini API
1. CrÃ©er un projet sur [Google AI Studio](https://makersuite.google.com/app/apikey)
2. GÃ©nÃ©rer une clÃ© API
3. Ajouter la clÃ© dans votre fichier `.env`

### Scripts disponibles

```bash
# DÃ©veloppement
npm run dev         # Lance le serveur de dÃ©veloppement

# Construction
npm run build       # Compile l'application pour production

# Preview
npm run preview     # PrÃ©visualise la version de production en local

# Lint
npm run lint        # VÃ©rifie le code avec ESLint

# Type check
npm run typecheck   # VÃ©rifie les types TypeScript
```

### DÃ©ploiement en production

#### DÃ©ploiement sur Vercel
```bash
# Installation de Vercel CLI
npm install -g vercel

# DÃ©ploiement
vercel

# DÃ©ploiement en production
vercel --prod
```

#### DÃ©ploiement sur Netlify
1. Connecter votre dÃ©pÃ´t GitHub Ã  Netlify
2. Configurer les variables d'environnement dans le dashboard Netlify
3. Configurer les redirections pour le routage SPA (crÃ©er un fichier `_redirects` ou `netlify.toml`)

#### DÃ©ploiement manuel sur serveur
```bash
# Construction du projet
npm run build

# Le dossier "dist" contient l'application compilÃ©e
# Copier ce dossier sur votre serveur web
```

### Configuration des headers

Pour assurer le bon fonctionnement de l'application, certains headers sont nÃ©cessaires :

```
# Exemple pour Netlify (netlify.toml)
[[headers]]
  for = "/*"
    [headers.values]
    Content-Security-Policy = "default-src 'self'; connect-src 'self' https://api.spotify.com https://generativelanguage.googleapis.com; img-src 'self' data: https://*.scdn.co; media-src 'self' https://*.spotifycdn.com; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com;"
    Permissions-Policy = "geolocation=(self), microphone=()"
```

---

## Configuration et environnement

### Variables d'environnement

Le fichier `.env` contient toutes les variables nÃ©cessaires au fonctionnement de l'application :

```bash
# Spotify API
VITE_SPOTIFY_CLIENT_ID=your_spotify_client_id
VITE_SPOTIFY_CLIENT_SECRET=your_spotify_client_secret
VITE_SPOTIFY_REDIRECT_URI=http://localhost:3000/callback

# Google Gemini API
VITE_GEMINI_API_KEY=your_gemini_api_key

# App Configuration
VITE_APP_NAME="Mood Music"
VITE_APP_VERSION="1.2.0"
VITE_APP_ENV="development" # ou "production"
```

### Configuration de Vite

Le fichier `vite.config.ts` contient la configuration du build tool :

```typescript
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';
import { VitePWA } from 'vite-plugin-pwa';

export default defineConfig({
  plugins: [
    react(),
    VitePWA({
      registerType: 'autoUpdate',
      includeAssets: ['favicon.ico', 'robots.txt', 'apple-touch-icon.png'],
      manifest: {
        name: 'Mood Music',
        short_name: 'MoodMusic',
        description: 'DÃ©couvrez de la musique adaptÃ©e Ã  votre humeur',
        theme_color: '#0a0a0a',
        background_color: '#0a0a0a',
        icons: [
          // Configuration des icÃ´nes...
        ],
        start_url: '/',
        display: 'standalone',
        orientation: 'portrait',
      },
      workbox: {
        // Configuration du service worker...
      }
    }),
  ],
  resolve: {
    alias: {
      '@': '/src',
    },
  },
  server: {
    port: 3000,
  },
});
```

### Configuration de TailwindCSS

Le fichier `tailwind.config.js` contient les personnalisations du framework CSS :

```javascript
module.exports = {
  content: [
    "./index.html",
    "./src/**/*.{js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {
      colors: {
        // Extensions de couleurs personnalisÃ©es
      },
      fontFamily: {
        sans: ['Poppins', 'sans-serif'],
      },
      animation: {
        // Animations personnalisÃ©es
      },
      keyframes: {
        // Keyframes personnalisÃ©s
      },
      backdropBlur: {
        // Flous personnalisÃ©s
      },
    },
  },
  plugins: [
    // Plugins TailwindCSS...
  ],
}
```

### Configuration TypeScript

Le fichier `tsconfig.json` contient la configuration du compilateur TypeScript :

```json
{
  "compilerOptions": {
    "target": "ESNext",
    "lib": ["DOM", "DOM.Iterable", "ESNext"],
    "module": "ESNext",
    "skipLibCheck": true,
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "resolveJsonModule": true,
    "isolatedModules": true,
    "noEmit": true,
    "jsx": "react-jsx",
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "noFallthroughCasesInSwitch": true,
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": ["src"],
  "references": [{ "path": "./tsconfig.node.json" }]
}
```

### Configuration PWA

Le fichier `public/manifest.json` contient la configuration pour l'installation en tant qu'application :

```json
{
  "name": "Mood Music",
  "short_name": "MoodMusic",
  "description": "DÃ©couvrez de la musique adaptÃ©e Ã  votre humeur",
  "start_url": "/",
  "display": "standalone",
  "background_color": "#0a0a0a",
  "theme_color": "#8B5CF6",
  "orientation": "portrait",
  "icons": [
    {
      "src": "icons/mood-72.png",
      "sizes": "72x72",
      "type": "image/png"
    },
    // Autres tailles d'icÃ´nes...
  ]
}
```

---

## Structure du code et conventions

### Architecture des dossiers

La structure de dossiers suit le principe de sÃ©paration des prÃ©occupations :

- **components/** : Interface utilisateur, organisÃ©e par fonctionnalitÃ© et composants communs
- **services/** : Logique mÃ©tier et interaction avec les APIs
- **hooks/** : Logique de composant rÃ©utilisable
- **types/** : DÃ©finitions TypeScript
- **config/** : Configuration de l'application
- **utils/** : Fonctions utilitaires
- **pages/** : Composants de niveau page
- **assets/** : Ressources statiques non publicques

### Conventions de nommage

- **Composants** : PascalCase (ex: `MoodSelector.tsx`)
- **Hooks** : camelCase commenÃ§ant par "use" (ex: `useMood.ts`)
- **Services** : camelCase (ex: `music.service.ts`)
- **Utils** : camelCase (ex: `formatters.ts`)
- **Types** : interfaces en PascalCase (ex: `interface MoodTags`)
- **Constantes** : UPPER_SNAKE_CASE (ex: `SAFE_SPOTIFY_GENRES`)

### Design patterns utilisÃ©s

1. **Component pattern** : Composants React rÃ©utilisables et modulaires
2. **Custom Hooks pattern** : Abstraction de la logique dans des hooks spÃ©cialisÃ©s
3. **Service pattern** : Encapsulation de la logique mÃ©tier dans des services
4. **Provider pattern** : Utilisation de React Context pour l'Ã©tat global
5. **Composition over inheritance** : PrÃ©fÃ©rence pour la composition de composants
6. **Controlled components** : Gestion explicite de l'Ã©tat des formulaires

### Styles de codage

Le projet suit des conventions strictes pour maintenir la cohÃ©rence du code :

- **Formatage** : Prettier avec configuration standard
- **Linting** : ESLint avec rÃ¨gles React et TypeScript
- **Imports** : GroupÃ©s et triÃ©s par type (React, libs, components, etc.)
- **Typages** : TypeScript strict avec interfaces explicites
- **Tests** : Tests unitaires pour les fonctions critiques

### Exemples de patterns de code

#### Custom Hook Pattern
```typescript
// src/hooks/useMood.ts
export const useMood = () => {
  const [isAnalyzing, setIsAnalyzing] = useState<boolean>(false);
  const [analysisResult, setAnalysisResult] = useState<MoodAnalysisResult | null>(null);
  const [recommendedTracks, setRecommendedTracks] = useState<Track[]>([]);
  
  const analyzeMoodFromText = useCallback(async (text: string) => {
    setIsAnalyzing(true);
    try {
      const analysis = await aiService.analyzeMood(text);
      setAnalysisResult(analysis);
      
      // Obtenir des recommandations basÃ©es sur l'analyse
      const tracks = await getRecommendationsFromTags(analysis.moodTags);
      setRecommendedTracks(tracks);
      
      return analysis;
    } catch (error) {
      console.error("Error analyzing mood:", error);
      throw error;
    } finally {
      setIsAnalyzing(false);
    }
  }, []);
  
  // Autres mÃ©thodes et logiques...
  
  return {
    isAnalyzing,
    analysisResult,
    recommendedTracks,
    analyzeMoodFromText,
    // Autres Ã©lÃ©ments exposÃ©s...
  };
};
```

#### Component Composition
```typescript
// Usage de composition de composants
const MoodSpace = () => {
  // Ã‰tat et logique...
  
  return (
    <Layout>
      <div className="container mx-auto px-4">
        <h1 className="text-3xl font-bold">Votre Espace Mood</h1>
        
        {/* Composition de composants spÃ©cialisÃ©s */}
        <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
          <MoodChat 
            messages={messages}
            isAnalyzing={isAnalyzing}
            onSendMessage={handleSendMessage}
          />
          
          <MoodAnalyzer
            tags={analysisResult?.moodTags}
            recommendedTracks={recommendedTracks}
            isLoading={isAnalyzing}
            onCreatePlaylist={handleCreatePlaylist}
          />
        </div>
      </div>
    </Layout>
  );
};
```

---

## Workflows et performances

### Workflow de dÃ©veloppement

Le processus de dÃ©veloppement de Mood Music est basÃ© sur les bonnes pratiques de l'ingÃ©nierie logicielle :

1. **Planification** : DÃ©finition des fonctionnalitÃ©s et architecture
2. **DÃ©veloppement** : ImplÃ©mentation avec approche modulaire
3. **Test** : Tests manuels et automatisÃ©s
4. **Revue** : Validation de la qualitÃ© du code
5. **DÃ©ploiement** : Push vers le serveur de production
6. **Monitoring** : Suivi des performances et erreurs

### Processus de build

Le processus de build est gÃ©rÃ© par Vite et optimisÃ© pour les performances :

```bash
# Processus de build complet
npm run build

# Ce qui se passe en interne :
# 1. VÃ©rification TypeScript
# 2. ESLint check
# 3. GÃ©nÃ©ration des assets optimisÃ©s
# 4. Minification et bundling
# 5. GÃ©nÃ©ration des assets PWA
# 6. Optimisation des images
```

### StratÃ©gies d'optimisation

Plusieurs stratÃ©gies sont utilisÃ©es pour optimiser les performances :

1. **Code splitting** : Chargement Ã  la demande des composants lourds
2. **Lazy loading** : Chargement diffÃ©rÃ© des images et ressources non critiques
3. **Preload critical resources** : PrÃ©chargement des ressources essentielles
4. **Tree shaking** : Ã‰limination du code mort
5. **Minification aggressive** : RÃ©duction de la taille du bundle
6. **Compression moderne** : Utilisation de formats optimisÃ©s (Brotli, WOFF2, etc.)
7. **Caching strategies** : Politiques de cache optimisÃ©es via le service worker

### MÃ©triques de performance

L'application est optimisÃ©e pour respecter les Web Vitals de Google :

- **FCP (First Contentful Paint)** : < 1.8s
- **LCP (Largest Contentful Paint)** : < 2.5s
- **FID (First Input Delay)** : < 100ms
- **CLS (Cumulative Layout Shift)** : < 0.1
- **TTI (Time to Interactive)** : < 3.8s

### Monitoring et analytics

Des outils de monitoring sont intÃ©grÃ©s pour suivre les performances et erreurs :

1. **Error logging** : Capture et rapport des erreurs non gÃ©rÃ©es
2. **Performance monitoring** : Suivi des mÃ©triques clÃ©s
3. **User analytics** : Suivi anonymisÃ© des interactions utilisateur
4. **API usage** : Monitoring de l'utilisation des APIs externes

---
## FAQ et troubleshooting

### Questions frÃ©quentes

#### 1. Comment fonctionne l'analyse d'humeur par IA ?
L'application utilise l'API Google Gemini pour analyser votre description textuelle ou votre image. L'IA identifie les Ã©motions, l'intensitÃ© Ã©motionnelle, et les traduit en paramÃ¨tres musicaux comme le genre, le tempo ou l'atmosphÃ¨re. Ces paramÃ¨tres sont ensuite utilisÃ©s pour rechercher des morceaux adaptÃ©s via l'API Spotify.

#### 2. Mes donnÃ©es sont-elles sÃ©curisÃ©es ?
Oui. Mood Music ne stocke pas vos descriptions d'humeur ou vos images sur des serveurs externes. L'historique d'humeur est sauvegardÃ© uniquement sur votre propre appareil. Concernant Spotify, nous n'accÃ©dons qu'aux donnÃ©es autorisÃ©es par vous lors de la connexion et ne stockons jamais votre mot de passe.

#### 3. Puis-je utiliser l'application sans compte Spotify ?
Absolument ! Vous pouvez utiliser toutes les fonctionnalitÃ©s d'analyse d'humeur et recevoir des recommandations musicales sans vous connecter. La connexion Ã  Spotify ajoute simplement la possibilitÃ© de crÃ©er des playlists et de synchroniser vos prÃ©fÃ©rences.

#### 4. L'application fonctionne-t-elle hors ligne ?
Partiellement. En tant que PWA, Mood Music peut Ãªtre installÃ©e et lancÃ©e hors ligne. Cependant, les fonctionnalitÃ©s d'analyse et de recommandation nÃ©cessitent une connexion internet pour communiquer avec les APIs Google Gemini et Spotify.

#### 5. Puis-je suggÃ©rer de nouvelles fonctionnalitÃ©s ?
Bien sÃ»r ! Mood Music est un projet open-source en constante Ã©volution. Vous pouvez proposer des amÃ©liorations en crÃ©ant une issue sur GitHub ou en contactant directement le dÃ©veloppeur via la page Contact.

### DÃ©pannage courant

#### L'analyse d'humeur ne fonctionne pas
- **SymptÃ´me** : L'analyse reste bloquÃ©e ou Ã©choue.
- **Solutions** :
   - VÃ©rifiez votre connexion internet
   - Assurez-vous que votre description est suffisamment dÃ©taillÃ©e (au moins 10 mots)
   - Pour les images, vÃ©rifiez qu'elles respectent la taille maximale (5MB)
   - Essayez de recharger la page et rÃ©essayez

#### Aucune recommandation musicale n'apparaÃ®t
- **SymptÃ´me** : L'analyse se termine mais aucun morceau n'est affichÃ©.
- **Solutions** :
   - Essayez une description d'humeur plus prÃ©cise
   - VÃ©rifiez que les genres mentionnÃ©s sont standards (pop, rock, jazz...)
   - Activez les logs dans la console pour identifier l'erreur spÃ©cifique
   - Essayez d'utiliser le mode sans connexion Spotify si vous Ãªtes connectÃ©

#### Authentification Spotify Ã©choue
- **SymptÃ´me** : Erreur lors de la connexion Ã  Spotify.
- **Solutions** :
   - Assurez-vous que les cookies sont activÃ©s dans votre navigateur
   - VÃ©rifiez que vous avez autorisÃ© les popups pour le site
   - Essayez de vous dÃ©connecter de Spotify puis reconnectez-vous
   - Effacez le cache du navigateur et rÃ©essayez

#### L'application est lente ou peu responsive
- **SymptÃ´me** : Interface lente, animations saccadÃ©es.
- **Solutions** :
   - Essayez de rafraÃ®chir la page
   - Fermez les autres onglets gourmands en ressources
   - DÃ©sactivez les extensions de navigateur non essentielles
   - Sur mobile, vÃ©rifiez l'espace disponible sur votre appareil
   - Utilisez un navigateur rÃ©cent (Chrome, Firefox, Safari, Edge)

#### ProblÃ¨mes avec la localisation
- **SymptÃ´me** : Impossible d'obtenir la position actuelle ou les recommandations rÃ©gionales.
- **Solutions** :
   - VÃ©rifiez que vous avez autorisÃ© la gÃ©olocalisation dans votre navigateur
   - Essayez de rechercher manuellement un lieu au lieu d'utiliser la dÃ©tection automatique
   - Sur certains appareils, dÃ©sactivez temporairement le VPN qui peut interfÃ©rer
   - Si aucun rÃ©sultat n'apparaÃ®t pour votre pays, essayez un pays plus populaire

### Contact support

Si vous rencontrez un problÃ¨me non rÃ©solu, plusieurs options s'offrent Ã  vous :

1. **GitHub Issues** : CrÃ©ez une issue dÃ©taillÃ©e sur le dÃ©pÃ´t GitHub
2. **Page Contact** : Utilisez le formulaire de contact dans l'application
3. **Email direct** : Contactez support@moodmusic.app
4. **WhatsApp** : Pour une assistance rapide, utilisez le contact WhatsApp dans la page Contact

---

## Contribution et dÃ©veloppement

### Comment contribuer

Mood Music est un projet open-source et accueille les contributions de toute nature. Voici comment vous pouvez participer :

#### 1. Signaler des bugs ou suggÃ©rer des amÃ©liorations
- CrÃ©ez une issue sur GitHub avec une description dÃ©taillÃ©e
- Utilisez les templates fournis pour les rapports de bug ou suggestions
- Incluez des captures d'Ã©cran ou logs si possible

#### 2. Contribuer du code
1. **Fork** le dÃ©pÃ´t
2. **Clonez** votre fork : `git clone https://github.com/your-username/mood-music.git`
3. **CrÃ©ez une branche** : `git checkout -b feature/amazing-feature`
4. **Committez** vos modifications : `git commit -m 'Add amazing feature'`
5. **Poussez** vers votre fork : `git push origin feature/amazing-feature`
6. **Ouvrez une Pull Request** vers le dÃ©pÃ´t principal

#### 3. AmÃ©liorer la documentation
- Corrigez les typos ou clarifiez les explications existantes
- Ajoutez des exemples ou des tutoriels pour les fonctionnalitÃ©s complexes
- Traduisez la documentation dans d'autres langues

#### 4. Partager et promouvoir
- Partagez l'application sur les rÃ©seaux sociaux
- Ã‰crivez des articles ou crÃ©ez des tutoriels sur son utilisation
- Proposez des idÃ©es d'intÃ©gration avec d'autres services

### Guide de contribution technique

#### Standards de code
- Respectez les conventions de style existantes
- Assurez-vous que tout le code est typÃ© avec TypeScript
- Suivez les principes DRY (Don't Repeat Yourself) et SOLID
- Commentez le code complexe et documentez les nouvelles fonctionnalitÃ©s
- Utilisez des noms de variables et de fonctions descriptifs

#### Tests
- Ajoutez des tests pour les nouvelles fonctionnalitÃ©s
- Assurez-vous que tous les tests existants passent
- Testez sur diffÃ©rents navigateurs et appareils si possible

#### Commits
- Utilisez des messages de commit clairs et descriptifs
- Suivez la convention [Conventional Commits](https://www.conventionalcommits.org/)
- Regroupez les modifications logiquement (ne mÃ©langez pas les fonctionnalitÃ©s)

#### Pull Requests
- DÃ©crivez clairement les modifications apportÃ©es
- RÃ©fÃ©rencez les issues correspondantes
- Incluez des captures d'Ã©cran pour les modifications visuelles
- Soyez rÃ©ceptif aux commentaires et suggestions

### Setup de dÃ©veloppement avancÃ©

#### Environnement de dÃ©veloppement recommandÃ©
- **IDE** : Visual Studio Code avec extensions React/TypeScript
- **Navigateurs** : Chrome + React DevTools et Firefox Developer Edition
- **Terminal** : IntÃ©grÃ© Ã  VSCode ou iTerm2/Windows Terminal

#### Extensions VSCode recommandÃ©es
- ESLint
- Prettier
- Tailwind CSS IntelliSense
- ES7+ React/Redux/React-Native snippets
- Error Lens
- GitLens

#### Debugging
- Utilisez les DevTools du navigateur pour le dÃ©bogage frontend
- Activez les logs dÃ©taillÃ©s avec `localStorage.setItem('debug', 'true')`
- Pour les problÃ¨mes d'API, utilisez l'onglet Network des DevTools
- Pour le dÃ©bogage TypeScript, configurez le sourcemapping dans VSCode

---

## Licence et crÃ©dits

### Licence

Mood Music est distribuÃ©e sous la licence MIT. Voir le fichier [LICENSE](LICENSE) pour plus de dÃ©tails.

```
MIT License

Copyright (c) 2025 TheTigerFox

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
```

### APIs et services tiers

Mood Music repose sur plusieurs APIs et services tiers :

- **Spotify API** : Pour les donnÃ©es musicales et la gestion des playlists
- **Google Gemini API** : Pour l'analyse d'humeur et la vision par ordinateur
- **OpenStreetMap** : Pour les fonctionnalitÃ©s cartographiques
- **FontAwesome** : Pour les icÃ´nes
- **Google Fonts** : Pour la typographie

### CrÃ©dits de dÃ©veloppement

DÃ©veloppÃ© par [TheTigerFox](https://github.com/theTigerFox)

### Remerciements

Un grand merci Ã  :

- La communautÃ© open-source pour les bibliothÃ¨ques et outils utilisÃ©s
- Les testeurs bÃªta qui ont fourni des retours prÃ©cieux
- Les contributeurs qui ont amÃ©liorÃ© le projet
- Spotify et Google pour leurs APIs puissantes

---

<p align="center">
  <img src="public/icons/mood-192.png" alt="Mood Music Logo" width="64" height="64"><br>
  <strong>Mood Music</strong><br>
  Ta musique en fonction de ton mood<br>
  <small>Â© 2025 Fox - v1.2.0</small><br>
  <a href="https://github.com/Tiger-Foxx/">GitHub</a> â€¢
  <a href="mailto:donfackarthur750@gmail.com">Contact</a>
</p>
